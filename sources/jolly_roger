source "sources/episode.sh"

function programme() {
  local repertoire_episodes=$1
  local repertoire_soustitres=$2
  local episode
  for episode in $(find "${repertoire_episodes}" -name "*.avi"); do
    _copie_le_soustitre_qui_correspond
  done
}

function _copie_le_soustitre_qui_correspond() {
  local soustitre
  for soustitre in $(find "${repertoire_soustitres}" -name "*.srt"); do
    _si_le_soustitre_correspond_copie_le
  done
}

function _si_le_soustitre_correspond_copie_le() {
  if episode__correspondent "${episode}" "${soustitre}"; then
    local chemin_soustitre="$(episode__chemin_soustitre "${episode}")"
    cp "${soustitre}" "${chemin_soustitre}"
  fi
}

programme "$@"